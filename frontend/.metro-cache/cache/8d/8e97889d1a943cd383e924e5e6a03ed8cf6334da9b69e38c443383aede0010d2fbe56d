{"dependencies":[{"name":"../keyframes","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":15},"end":{"line":3,"column":74,"index":89}}],"key":"mxvMhs55oq9jgpEsSFkkE4J0Ers=","exportNames":["*"],"imports":1}},{"name":"../normalization","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":90},"end":{"line":4,"column":136,"index":226}}],"key":"qzlZGcgXwl9ZPF9i7tZ8rdYWgeY=","exportNames":["*"],"imports":1}},{"name":"../proxy","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":227},"end":{"line":5,"column":71,"index":298}}],"key":"7t6p+wFqa3TKNDAU+WlzybERgtk=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function(g,r,_i,a,m,e,d){'use strict';Object.defineProperty(e,'__esModule',{value:!0}),Object.defineProperty(e,\"default\",{enumerable:!0,get:function(){return n}});var t=r(d[0]),s=r(d[1]),i=r(d[2]);class n{attachedAnimations=[];constructor(t,s,i){this.shadowNodeWrapper=t,this.viewName=s,this.viewTag=i}update(t){if(!t)return void this.detach();const s=this.processAnimations(t);this.registerKeyframesUsage(s);const n=this.getAnimationUpdates(s);if(this.attachedAnimations=s,n){if(n.animationNames&&0===n.animationNames.length)return void this.detach();(0,i.applyCSSAnimations)(this.shadowNodeWrapper,n)}}unmountCleanup(){this.unregisterKeyframesUsage()}detach(){this.attachedAnimations.length>0&&((0,i.unregisterCSSAnimations)(this.viewTag),this.unregisterKeyframesUsage(),this.attachedAnimations=[])}registerKeyframesUsage(s){const i=new Set;s.forEach(({keyframesRule:s})=>{t.cssKeyframesRegistry.add(s,this.viewName,this.viewTag),i.add(s.name)}),this.attachedAnimations.forEach(({keyframesRule:{name:s}})=>{i.has(s)||t.cssKeyframesRegistry.remove(s,this.viewName,this.viewTag)})}unregisterKeyframesUsage(){this.attachedAnimations.forEach(({keyframesRule:{name:s}})=>{t.cssKeyframesRegistry.remove(s,this.viewName,this.viewTag)})}processAnimations(i){return(0,s.createSingleCSSAnimationProperties)(i).map(i=>{const n=i.animationName;let o;if(n instanceof t.CSSKeyframesRuleImpl)o=n;else{const s=JSON.stringify(n);o=t.cssKeyframesRegistry.get(s)??new t.CSSKeyframesRuleImpl(n,s)}return{normalizedSettings:(0,s.normalizeSingleCSSAnimationSettings)(i),keyframesRule:o}})}buildAnimationsMap(t){return t.reduceRight((t,s)=>{const i=s.keyframesRule.name;return t[i]?t[i].push(s):t[i]=[s],t},{})}getAnimationUpdates(t){const i={},n={};let o=this.attachedAnimations.length!==t.length,h=!1,c=!1;const u=this.buildAnimationsMap(this.attachedAnimations);t.forEach(({keyframesRule:t,normalizedSettings:l},f)=>{const y=u[t.name]?.pop();if(!y)return h=!0,o=!0,void(i[f]=l);const p=(0,s.getAnimationSettingsUpdates)(y.normalizedSettings,l);Object.keys(p).length>0&&(c=!0,n[f]=p),y.keyframesRule.name!==t.name&&(o=!0)});const l={};return o&&(l.animationNames=t.map(({keyframesRule:t})=>t.name)),h&&(l.newAnimationSettings=i),c&&(l.settingsUpdates=n),h||c||o?l:null}}});","lineCount":1,"map":[[1,29,1,0],[1,42,1,13,"Object"],[1,49,1,13,"defineProperty"],[1,64,1,13,"e"],[1,66,1,13],[1,80,1,13,"value"],[1,87,1,13],[1,91,6,15,"Object"],[1,98,6,15,"defineProperty"],[1,113,6,15,"e"],[1,115,6,15],[1,126,6,15,"enumerable"],[1,138,6,15],[1,140,6,15,"get"],[1,144,6,15],[1,162,6,15,"CSSAnimationsManager"],[1,163,6,15],[1,167,3,0],[1,171,3,0,"_keyframes"],[1,173,3,0,"r"],[1,175,3,0,"d"],[1,177,3,0],[1,181,4,0,"_normalization"],[1,183,4,0,"r"],[1,185,4,0,"d"],[1,187,4,0],[1,191,5,0,"_proxy"],[1,193,5,0,"r"],[1,195,5,0,"d"],[1,197,5,0],[1,201,6,15],[1,207,6,21,"CSSAnimationsManager"],[1,209,7,2,"attachedAnimations"],[1,228,7,23],[1,231,8,2,"constructor"],[1,243,8,14,"shadowNodeWrapper"],[1,245,8,33,"viewName"],[1,247,8,43,"viewTag"],[1,250,9,4,"this"],[1,255,9,9,"shadowNodeWrapper"],[1,273,9,29,"shadowNodeWrapper"],[1,275,10,4,"this"],[1,280,10,9,"viewName"],[1,289,10,20,"viewName"],[1,291,11,4,"this"],[1,296,11,9,"viewTag"],[1,304,11,19,"viewTag"],[1,305,12,2],[1,306,13,2,"update"],[1,313,13,9,"animationProperties"],[1,316,14,4],[1,320,14,9,"animationProperties"],[1,322,16,6],[1,334,15,6,"this"],[1,339,15,11,"detach"],[1,348,18,4],[1,354,18,10,"processedAnimations"],[1,356,18,32,"this"],[1,361,18,37,"processAnimations"],[1,379,18,55,"animationProperties"],[1,382,19,4,"this"],[1,387,19,9,"registerKeyframesUsage"],[1,410,19,32,"processedAnimations"],[1,413,20,4],[1,419,20,10,"animationUpdates"],[1,421,20,29,"this"],[1,426,20,34,"getAnimationUpdates"],[1,446,20,54,"processedAnimations"],[1,449,22,4],[1,452,21,4,"this"],[1,457,21,9,"attachedAnimations"],[1,476,21,30,"processedAnimations"],[1,478,22,8,"animationUpdates"],[1,480,22,26],[1,481,23,6],[1,484,23,10,"animationUpdates"],[1,486,23,27,"animationNames"],[1,502,23,88],[1,506,23,45,"animationUpdates"],[1,508,23,62,"animationNames"],[1,523,23,77,"length"],[1,530,25,8],[1,542,24,8,"this"],[1,547,24,13,"detach"],[1,557,27,6],[1,559,27,6,"applyCSSAnimations"],[1,561,27,24,"applyCSSAnimations"],[1,581,27,25,"this"],[1,586,27,30,"shadowNodeWrapper"],[1,604,27,49,"animationUpdates"],[1,606,28,4],[1,607,29,2],[1,608,30,2,"unmountCleanup"],[1,625,31,4,"this"],[1,630,31,9,"unregisterKeyframesUsage"],[1,656,32,2],[1,657,33,2,"detach"],[1,666,34,8,"this"],[1,671,34,13,"attachedAnimations"],[1,690,34,32,"length"],[1,697,34,41],[1,702,35,6],[1,704,35,6,"unregisterCSSAnimations"],[1,706,35,29,"unregisterCSSAnimations"],[1,731,35,30,"this"],[1,736,35,35,"viewTag"],[1,745,36,6,"this"],[1,750,36,11,"unregisterKeyframesUsage"],[1,777,37,6,"this"],[1,782,37,11,"attachedAnimations"],[1,801,37,32],[1,804,39,2],[1,805,40,2,"registerKeyframesUsage"],[1,828,40,25,"processedAnimations"],[1,831,41,4],[1,837,41,10,"newAnimationNames"],[1,839,41,30],[1,843,41,34,"Set"],[1,847,44,4,"processedAnimations"],[1,849,44,24,"forEach"],[1,857,44,32],[1,859,45,6,"keyframesRule"],[1,879,47,6,"cssKeyframesRegistry"],[1,881,47,26,"cssKeyframesRegistry"],[1,902,47,27,"add"],[1,906,47,31,"keyframesRule"],[1,908,47,46,"this"],[1,913,47,51,"viewName"],[1,922,47,61,"this"],[1,927,47,66,"viewTag"],[1,936,48,6,"newAnimationNames"],[1,938,48,24,"add"],[1,942,48,28,"keyframesRule"],[1,944,48,42,"name"],[1,952,53,4,"this"],[1,957,53,9,"attachedAnimations"],[1,976,53,28,"forEach"],[1,984,53,36],[1,986,54,6,"keyframesRule"],[1,1001,55,8,"name"],[1,1013,58,11,"newAnimationNames"],[1,1015,58,29,"has"],[1,1019,58,33,"name"],[1,1023,59,8,"cssKeyframesRegistry"],[1,1025,59,28,"cssKeyframesRegistry"],[1,1046,59,29,"remove"],[1,1053,59,36,"name"],[1,1055,59,42,"this"],[1,1060,59,47,"viewName"],[1,1069,59,57,"this"],[1,1074,59,62,"viewTag"],[1,1084,62,2],[1,1085,63,2,"unregisterKeyframesUsage"],[1,1112,66,4,"this"],[1,1117,66,9,"attachedAnimations"],[1,1136,66,28,"forEach"],[1,1144,66,36],[1,1146,67,6,"keyframesRule"],[1,1161,68,8,"name"],[1,1173,71,6,"cssKeyframesRegistry"],[1,1175,71,26,"cssKeyframesRegistry"],[1,1196,71,27,"remove"],[1,1203,71,34,"name"],[1,1205,71,40,"this"],[1,1210,71,45,"viewName"],[1,1219,71,55,"this"],[1,1224,71,60,"viewTag"],[1,1234,73,2],[1,1235,74,2,"processAnimations"],[1,1253,74,20,"animationProperties"],[1,1256,100,4],[1,1263,75,43],[1,1265,75,43,"createSingleCSSAnimationProperties"],[1,1267,75,77,"createSingleCSSAnimationProperties"],[1,1303,75,78,"animationProperties"],[1,1306,76,63,"map"],[1,1310,76,67,"properties"],[1,1314,77,6],[1,1320,77,12,"keyframes"],[1,1322,77,24,"properties"],[1,1324,77,35,"animationName"],[1,1338,78,6],[1,1342,78,10,"keyframesRule"],[1,1344,79,6],[1,1347,79,10,"keyframes"],[1,1360,79,31,"CSSKeyframesRuleImpl"],[1,1362,79,51,"CSSKeyframesRuleImpl"],[1,1383,84,8,"keyframesRule"],[1,1385,84,24,"keyframes"],[1,1391,85,13],[1,1392,92,8],[1,1398,92,14,"cssText"],[1,1400,92,24,"JSON"],[1,1405,92,29,"stringify"],[1,1415,92,39,"keyframes"],[1,1418,93,8,"keyframesRule"],[1,1420,93,24,"cssKeyframesRegistry"],[1,1422,93,44,"cssKeyframesRegistry"],[1,1443,93,45,"get"],[1,1447,93,49,"cssText"],[1,1451,93,61],[1,1455,93,65,"CSSKeyframesRuleImpl"],[1,1457,93,85,"CSSKeyframesRuleImpl"],[1,1478,93,86,"keyframes"],[1,1480,93,97,"cssText"],[1,1482,94,6],[1,1483,95,6],[1,1489,95,13],[1,1490,96,8,"normalizedSettings"],[1,1510,96,28],[1,1512,96,28,"normalizeSingleCSSAnimationSettings"],[1,1514,96,63,"normalizeSingleCSSAnimationSettings"],[1,1551,96,64,"properties"],[1,1554,97,8,"keyframesRule"],[1,1572,101,2],[1,1573,102,2,"buildAnimationsMap"],[1,1592,102,21,"animations"],[1,1595,105,4],[1,1602,105,11,"animations"],[1,1604,105,22,"reduceRight"],[1,1616,105,34],[1,1617,105,35,"acc"],[1,1619,105,40,"animation"],[1,1624,106,6],[1,1630,106,12,"name"],[1,1632,106,19,"animation"],[1,1634,106,29,"keyframesRule"],[1,1648,106,43,"name"],[1,1653,112,6],[1,1660,107,11,"acc"],[1,1662,107,15,"name"],[1,1665,110,8,"acc"],[1,1667,110,12,"name"],[1,1670,110,18,"push"],[1,1675,110,23,"animation"],[1,1678,108,8,"acc"],[1,1680,108,12,"name"],[1,1683,108,20],[1,1684,108,21,"animation"],[1,1687,112,13,"acc"],[1,1690,113,7],[1,1691,113,8],[1,1693,114,2],[1,1694,115,2,"getAnimationUpdates"],[1,1714,115,22,"processedAnimations"],[1,1717,116,4],[1,1723,116,10,"newAnimationSettings"],[1,1725,116,33],[1,1726,116,34],[1,1728,117,10,"settingsUpdates"],[1,1730,117,28],[1,1731,117,29],[1,1733,118,4],[1,1737,118,8,"animationsArrayChanged"],[1,1739,118,33,"this"],[1,1744,118,38,"attachedAnimations"],[1,1763,118,57,"length"],[1,1772,118,68,"processedAnimations"],[1,1774,118,88,"length"],[1,1781,119,8,"hasNewAnimations"],[1,1784,119,27],[1,1786,120,8,"hasSettingsUpdates"],[1,1789,120,29],[1,1791,121,4],[1,1797,121,10,"oldAnimations"],[1,1799,121,26,"this"],[1,1804,121,31,"buildAnimationsMap"],[1,1823,121,50,"this"],[1,1828,121,55,"attachedAnimations"],[1,1848,122,4,"processedAnimations"],[1,1850,122,24,"forEach"],[1,1858,122,32],[1,1860,123,6,"keyframesRule"],[1,1876,124,6,"normalizedSettings"],[1,1898,125,7,"i"],[1,1903,126,6],[1,1909,126,12,"oldAnimation"],[1,1911,126,27,"oldAnimations"],[1,1913,126,41,"keyframesRule"],[1,1915,126,55,"name"],[1,1922,126,62,"pop"],[1,1928,127,6],[1,1932,127,11,"oldAnimation"],[1,1934,131,8],[1,1941,128,8,"hasNewAnimations"],[1,1944,128,27],[1,1946,129,8,"animationsArrayChanged"],[1,1949,129,33],[1,1956,130,8,"newAnimationSettings"],[1,1958,130,29,"i"],[1,1961,130,34,"normalizedSettings"],[1,1964,133,6],[1,1970,133,12,"updates"],[1,1973,133,22],[1,1975,133,22,"getAnimationSettingsUpdates"],[1,1977,133,49,"getAnimationSettingsUpdates"],[1,2006,133,50,"oldAnimation"],[1,2008,133,63,"normalizedSettings"],[1,2027,133,83,"normalizedSettings"],[1,2030,134,10,"Object"],[1,2037,134,17,"keys"],[1,2042,134,22,"updates"],[1,2045,134,31,"length"],[1,2052,134,40],[1,2056,135,8,"hasSettingsUpdates"],[1,2059,135,29],[1,2061,136,8,"settingsUpdates"],[1,2063,136,24,"i"],[1,2066,136,29,"updates"],[1,2069,138,10,"oldAnimation"],[1,2071,138,23,"keyframesRule"],[1,2085,138,37,"name"],[1,2092,138,46,"keyframesRule"],[1,2094,138,60,"name"],[1,2101,139,8,"animationsArrayChanged"],[1,2104,139,33],[1,2109,142,4],[1,2115,142,10,"result"],[1,2117,142,19],[1,2118,142,20],[1,2120,154,4],[1,2127,143,8,"animationsArrayChanged"],[1,2131,144,6,"result"],[1,2133,144,13,"animationNames"],[1,2148,144,30,"processedAnimations"],[1,2150,144,50,"map"],[1,2154,144,54],[1,2156,145,8,"keyframesRule"],[1,2175,146,12,"keyframesRule"],[1,2177,146,26,"name"],[1,2184,148,8,"hasNewAnimations"],[1,2188,149,6,"result"],[1,2190,149,13,"newAnimationSettings"],[1,2211,149,36,"newAnimationSettings"],[1,2214,151,8,"hasSettingsUpdates"],[1,2218,152,6,"result"],[1,2220,152,13,"settingsUpdates"],[1,2236,152,31,"settingsUpdates"],[1,2239,154,8,"hasNewAnimations"],[1,2242,154,28,"hasSettingsUpdates"],[1,2245,154,50,"animationsArrayChanged"],[1,2247,155,13,"result"],[1,2249,157,11],[1,2253,158,2],[1,2255,159,1],[1,2258]],"functionMap":{"names":["<global>","CSSAnimationsManager","constructor","update","unmountCleanup","detach","registerKeyframesUsage","processedAnimations.forEach$argument_0","attachedAnimations.forEach$argument_0","unregisterKeyframesUsage","processAnimations","singleAnimationPropertiesArray.map$argument_0","buildAnimationsMap","animations.reduceRight$argument_0","getAnimationUpdates","processedAnimations.map$argument_0"],"mappings":"AAA;eCK;ECE;GDI;EEC;GFgB;EGC;GHE;EIC;GJM;EKC;gCCI;KDK;oCEI;KFQ;GLC;EQC;oCDG;KCM;GRC;ESC;mECE;KDuB;GTE;EWC;kCCG;KDQ;GXC;EaC;gCPO;KOmB;sDCG;8BDE;GbY;CDC"},"hasCjsExports":false},"type":"js/module"}]}